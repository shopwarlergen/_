<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Blox Fruits - War Legend</title>
  <style>
    body {font-family: Arial; background:#f5f7fa; margin:0; color:#000}
    header {background:#444; color:#fff; padding:10px 20px; display:flex; justify-content:space-between; align-items:center}
    nav a {color:#fff; margin:0 10px; text-decoration:none; font-weight:bold}
    .container {max-width:800px; margin:30px auto; background:#fff; padding:20px; border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,0.1)}
    .preview img {width:100%; border-radius:6px; margin-bottom:12px}
    label {display:block; margin:10px 0 6px; font-weight:700}
    select, input, textarea {width:100%; padding:10px; border:1px solid #ccc; border-radius:6px}
    select {max-height:180px; overflow-y:auto}
    textarea {height:80px; resize:vertical}
    button {margin-top:14px; padding:10px 16px; border-radius:6px; border:0; background:#28a745; color:#fff; cursor:pointer}
  </style>
</head>
<body>

  <header>
    <div><strong>War Legend</strong></div>
    <nav>
      <a href="shop.html">üè† Shop</a>
      <a href="prizes.html">üéÅ Gi·∫£i th∆∞·ªüng</a>
      <a href="admin.html" id="adminLink" style="display:none">‚öôÔ∏è Admin</a>
    </nav>
  </header>

  <div class="container">
    <h2>üçá Blox Fruits</h2>

    <div class="preview">
      <img src="https://tr.rbxcdn.com/180DAY-37cc49a6bdb03b5a4394db84ff264fe5/768/432/Image/Webp/noFilter" alt="Blox Fruits">
    </div>

    <form id="orderForm">
      <label>* Ch·ªçn G√≥i C·∫ßn Thu√™</label>
      <select id="pkg"></select>

      <label>T√†i kho·∫£n</label>
      <input id="acc" required>

      <label>M·∫≠t kh·∫©u</label>
      <input id="pwd" type="password" required>

      <label>Ghi ch√∫</label>
      <textarea id="note"></textarea>

      <button type="submit">T·∫°o ƒë∆°n</button>
    </form>
  </div>

  <script>
    (function(){
      const cur = JSON.parse(localStorage.getItem('currentUser') || 'null');

      if(cur && (cur.role === 'admin' || cur.role === 'owner')) {
        document.getElementById('adminLink').style.display = 'inline-block';
      }

      const pkgs = JSON.parse(localStorage.getItem('services') || '[]');
      const sel = document.getElementById('pkg');

      if(!pkgs.length) {
        sel.innerHTML = '<option disabled>Ch∆∞a c√≥ g√≥i</option>';
      }
      else {
        sel.innerHTML = pkgs.map((p, i) => 
          `<option value="${i}">${p.name} - ${Number(p.price||0).toLocaleString()} ‚Ç´</option>`
        ).join('');
      }

      document.getElementById('orderForm').addEventListener('submit', e => {
        e.preventDefault();

        const idx = parseInt(sel.value);
        if(isNaN(idx)) {
          alert('Ch·ªçn g√≥i!');
          return;
        }

        const orders = JSON.parse(localStorage.getItem('orders') || '[]');

        const o = {
          game: 'Blox Fruits',
          package: pkgs[idx].name,
          price: pkgs[idx].price,
          acc: document.getElementById('acc').value,
          note: document.getElementById('note').value,
          time: new Date().toLocaleString(),
          status: 'pending'
        };

        orders.push(o);
        localStorage.setItem('orders', JSON.stringify(orders));

        alert('‚úÖ ƒê√£ t·∫°o ƒë∆°n!');
        e.target.reset();
      });
    })();
  </script>

</body>
</html>
